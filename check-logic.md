---
description: 检查章节逻辑问题（因果、动机、时间线、信息差）
argument-hint: <卷号> <起始章>-<结束章>
---

# 逻辑检查任务：$ARGUMENTS

> **核心目标**：发现并修复章节中"读起来不对劲"的逻辑问题
> 
> **与其他检查的区别**：
> - `check-consistency`：检查设定是否一致（名字、数值、状态）
> - `check-structure`：检查宏观结构是否完整
> - **`check-logic`**：检查微观逻辑是否通顺（因果、动机、信息流）

---

## 第一步：读取必要文件

### 1.1 核心规范
1. `AGENTS.md` - 人设铁律、写作规范
2. `小说规划.md` - 整体设定

### 1.2 人物档案
> ⚠️ **必须先列出 `人物档案/` 目录，根据实际文件名读取，禁止使用模板占位符**

3. `人物档案/` - 列出目录，读取主要角色档案
4. 主角内核档案（从目录中查找实际文件名）

### 1.3 世界观文件
5. LS `世界观/` 目录，按需读取相关文件（世界观总览、能力体系、等级体系等）

### 1.4 本卷上下文
7. `卷X-卷名/卷X大纲.md` - 本卷规划
8. `卷X-卷名/章节摘要.md` - 已写章节摘要

### 1.5 动态状态
9. `动态状态/人物当前状态.md` - 人物最新状态

### 1.6 全书记忆
10. `全书记忆/伏笔追踪表.md` - 伏笔状态
11. `全书记忆/人物里程碑.md` - 人物成长记录
12. `全书记忆/感情线节点.md` - 感情线进度（如有感情线）
13. `全书记忆/世界线进度.md` - 时间线、大事件记录

### 1.7 待检查章节
14. 读取指定范围的所有章节文件

---

## 第二步：构建上下文地图

> **先理清上下文，再逐章检查**

### 2.1 构建时间线

```markdown
## 时间线地图

| 章节 | 时间点 | 持续时长 | 关键事件 |
|------|--------|----------|----------|
| 第X章 | D+X / 具体时间 | X小时/天 | [事件摘要] |
| 第X章 | D+X / 具体时间 | X小时/天 | [事件摘要] |
| ... | | | |
```

### 2.2 构建信息流图

```markdown
## 信息流追踪

| 信息 | 产生章节 | 知情角色 | 传播路径 |
|------|----------|----------|----------|
| [秘密/线索1] | 第X章 | [角色A] | A→B(第X章)→C(第X章) |
| [秘密/线索2] | 第X章 | [角色B] | 尚未传播 |
| ... | | | |
```

### 2.3 构建因果链图

```markdown
## 因果链追踪

事件1：[描述]（第X章）
   ↓ 因此
事件2：[描述]（第X章）
   ↓ 但是
事件3：[描述]（第X章）
   ↓ 因此
...
```

---

## 第三步：逐章逻辑检查

> **对每一章进行七重逻辑检验**

### 3.1 因果逻辑检查

**检查每个重要事件是否有合理的前因后果**

```markdown
### 事件因果检验

| 事件 | 前因 | 后果 | 问题诊断 |
|------|------|------|----------|
| [事件A] | [是否有铺垫？] | [是否有影响？] | ✓ / ⚠️ 无铺垫 / ⚠️ 无后果 |
| [事件B] | [是否有铺垫？] | [是否有影响？] | ✓ / ⚠️ |
| ... | | | |

**常见问题**：
- ❌ 巧合过多：事件发生靠运气而非逻辑
- ❌ 天降神兵：关键时刻有人/物凭空出现
- ❌ 无果而终：重大事件没有后续影响
- ❌ 因果倒置：结果出现在原因之前
```

### 3.2 人物动机逻辑检查

**检查角色行为是否有充分动机**

```markdown
### 行为动机检验

| 角色 | 行为 | 动机 | 问题诊断 |
|------|------|------|----------|
| [角色A] | [做了什么] | [为什么这么做？] | ✓ / ⚠️ 动机不足 / ⚠️ 动机矛盾 |
| [角色B] | [做了什么] | [为什么这么做？] | ✓ / ⚠️ |
| ... | | | |

**常见问题**：
- ❌ 无理由行动：角色行为没有动机支撑
- ❌ 智商下线：角色做出明显愚蠢的选择
- ❌ 性格突变：行为与人设严重不符
- ❌ 工具人化：配角只为推动剧情，无自身逻辑
```

### 3.3 信息逻辑检查

**检查角色是否"知道不该知道的"或"不知道该知道的"**

```markdown
### 信息逻辑检验

| 角色 | 表现出的认知 | 信息来源 | 问题诊断 |
|------|--------------|----------|----------|
| [角色A] | [知道某事] | [何时/如何知道的？] | ✓ / ⚠️ 信息来源不明 |
| [角色B] | [不知道某事] | [按理应该知道？] | ✓ / ⚠️ 信息遗忘 |
| ... | | | |

**常见问题**：
- ❌ 全知全能：角色知道不可能知道的信息
- ❌ 选择性遗忘：角色忘记了应该记得的事
- ❌ 信息传递断链：重要信息没有传播渠道却被人知道
- ❌ 秘密泄露：保密信息莫名其妙被人知道
```

### 3.4 时间逻辑检查

**检查时间线是否合理**

```markdown
### 时间逻辑检验

| 检查项 | 状态 | 问题详情 |
|--------|------|----------|
| 时间流逝连贯？ | ✓/✗ | [如有问题描述] |
| 事件顺序合理？ | ✓/✗ | |
| 持续时间合理？ | ✓/✗ | |
| 无时间穿越？ | ✓/✗ | |

**常见问题**：
- ❌ 时间压缩：太多事在不合理的短时间内发生
- ❌ 时间膨胀：简单事件耗时过长
- ❌ 时间错乱：事件A发生在事件B之后，但章节中反过来
- ❌ 时间断层：中间缺失了一段时间没有交代
```

### 3.5 空间逻辑检查

**检查地点转换是否合理**

```markdown
### 空间逻辑检验

| 角色 | 地点变化 | 移动方式 | 耗时 | 问题诊断 |
|------|----------|----------|------|----------|
| [角色A] | A→B | [步行/车/...] | [合理？] | ✓ / ⚠️ |
| ... | | | | |

**常见问题**：
- ❌ 瞬间移动：角色在不合理的短时间内到达远处
- ❌ 地点矛盾：同一时间出现在两个地方
- ❌ 空间错乱：地点描述前后不一致
- ❌ 移动断链：角色突然出现在新地点，没有交代如何到达
```

### 3.6 能力逻辑检查

**检查角色能力使用是否符合设定**

```markdown
### 能力逻辑检验

| 角色 | 使用的能力 | 是否符合设定？ | 问题诊断 |
|------|------------|----------------|----------|
| [角色A] | [能力/技能] | ✓/✗ | [如有问题] |
| ... | | | |

**常见问题**：
- ❌ 能力越界：使用了超出当前阶段的能力
- ❌ 能力遗忘：明明有能力却不用，导致困境
- ❌ 能力波动：同一能力效果时强时弱
- ❌ 代价忽略：使用能力没有付出相应代价
```

### 3.7 情感逻辑检查

**检查情绪变化是否有合理过渡**

```markdown
### 情感逻辑检验

| 角色 | 情绪变化 | 触发事件 | 问题诊断 |
|------|----------|----------|----------|
| [角色A] | [愤怒→平静] | [发生了什么？] | ✓ / ⚠️ 转变突兀 |
| [角色A] | [冷漠→关心] | [发生了什么？] | ✓ / ⚠️ 缺乏铺垫 |
| ... | | | |

**常见问题**：
- ❌ 情绪突变：没有过渡的情绪剧烈变化
- ❌ 情绪错位：经历重大事件后情绪反应不对
- ❌ 情绪遗忘：上一章的情绪状态被忽略
- ❌ 反应缺失：重大事件后角色毫无反应
```

---

## 第四步：跨章逻辑检查

> **单章逻辑可能没问题，但跨章节看会有矛盾**

### 4.1 承接逻辑检查

```markdown
### 章节承接检验

| 前章结尾 | 后章开头 | 承接是否合理 |
|----------|----------|--------------|
| [上章结束状态] | [下章开始状态] | ✓ / ⚠️ 断裂 / ⚠️ 矛盾 |
| ... | | |

**常见问题**：
- ❌ 状态跳跃：上章受伤，下章生龙活虎
- ❌ 情绪断裂：上章悲伤，下章突然开心
- ❌ 位置跳跃：上章在A地，下章突然在B地没有交代
- ❌ 物品消失：上章拿着的东西下章没了
```

### 4.2 线索连贯检查

```markdown
### 线索连贯检验

| 线索 | 埋设章节 | 后续提及 | 问题诊断 |
|------|----------|----------|----------|
| [线索1] | 第X章 | 第Y章提及/未提及 | ✓ / ⚠️ 被遗忘 |
| [线索2] | 第X章 | ... | |

**常见问题**：
- ❌ 线索遗忘：提出的疑问再没有下文
- ❌ 线索错位：线索解答与埋设矛盾
- ❌ 线索重复：同一线索多次"首次发现"
```

### 4.3 人物关系逻辑

```markdown
### 关系变化检验

| 关系 | 章节 | 状态 | 问题诊断 |
|------|------|------|----------|
| A与B | 第X章 | [敌对/友好/暧昧] | |
| A与B | 第Y章 | [状态变化] | ✓ / ⚠️ 变化无依据 |

**常见问题**：
- ❌ 关系突变：敌人突然变朋友没有铺垫
- ❌ 关系遗忘：已建立的关系被忽略
- ❌ 关系矛盾：同一关系在不同场景描述不一致
```

---

## 第五步：输出检查报告

```
╔══════════════════════════════════════════════════════════╗
║                   逻辑检查报告                            ║
╠══════════════════════════════════════════════════════════╣
║ 检查范围：卷X 第X章 - 第X章                               ║
║ 检查时间：YYYY-MM-DD                                     ║
╠══════════════════════════════════════════════════════════╣
║                                                          ║
║ 【因果逻辑】      ✓ 通过 / ⚠ X个问题                     ║
║ 【动机逻辑】      ✓ 通过 / ⚠ X个问题                     ║
║ 【信息逻辑】      ✓ 通过 / ⚠ X个问题                     ║
║ 【时间逻辑】      ✓ 通过 / ⚠ X个问题                     ║
║ 【空间逻辑】      ✓ 通过 / ⚠ X个问题                     ║
║ 【能力逻辑】      ✓ 通过 / ⚠ X个问题                     ║
║ 【情感逻辑】      ✓ 通过 / ⚠ X个问题                     ║
║ 【跨章承接】      ✓ 通过 / ⚠ X个问题                     ║
║                                                          ║
║ 总问题数：X 个                                           ║
║ 逻辑健康度：X/100                                        ║
╚══════════════════════════════════════════════════════════╝
```

---

## 第六步：详细问题清单

```markdown
## 发现的逻辑问题（共X个）

### 🔴 严重问题（破坏阅读体验）

#### 问题1：[因果断裂]
- **位置**：第X章 第X段
- **问题**：主角突然获得关键信息，但没有任何来源
- **原文**：「唐健知道对方的弱点是...」
- **分析**：前文没有任何铺垫说明主角如何获知这个信息
- **建议**：
  - 方案A：在前面章节增加获取信息的场景
  - 方案B：在本处增加信息来源的说明（如：根据观察推断）

#### 问题2：[动机缺失]
- **位置**：第X章 第X段
- **问题**：配角突然帮助主角，动机不明
- **原文**：「陌生人突然出手相助...」
- **分析**：这个角色没有帮助主角的理由
- **建议**：
  - 增加角色帮助的动机（利益交换/报恩/共同敌人）

### 🟡 中等问题（影响逻辑严谨性）

#### 问题3：[时间压缩]
- **位置**：第X章
- **问题**：主角在1小时内完成了需要5小时的事
- **分析**：时间设定不合理
- **建议**：调整时间跨度或简化事件

#### 问题4：[信息矛盾]
- **位置**：第X章 vs 第Y章
- **问题**：第X章说主角不知道某事，第Y章主角却表现得早就知道
- **建议**：统一信息状态

### 🟢 轻微问题（可选修复）

#### 问题5：[承接略显生硬]
- **位置**：第X章开头
- **问题**：与上章情绪衔接不够自然
- **建议**：增加过渡句
```

---

## 第七步：询问是否修复

```
发现逻辑问题：
- 🔴 严重：X个（必须修复）
- 🟡 中等：X个（建议修复）
- 🟢 轻微：X个（可选修复）

是否进行修复？

[1] 全部修复
[2] 仅修复严重和中等问题
[3] 仅修复严重问题
[4] 逐个确认后修复
[5] 不修复，仅保存报告

请选择 (1/2/3/4/5)：
```

---

## 第八步：执行修复

### 修复策略

| 问题类型 | 修复方式 |
|----------|----------|
| 因果断裂 | 补充铺垫/说明因果关系 |
| 动机缺失 | 增加角色动机说明 |
| 信息错误 | 修正信息来源/调整认知表现 |
| 时间问题 | 调整时间设定/增加时间过渡 |
| 空间问题 | 增加移动说明/调整地点 |
| 能力问题 | 调整能力表现/增加解释 |
| 情感问题 | 增加情绪过渡/调整反应 |
| 承接问题 | 增加过渡内容 |

### 修复原则

1. **最小改动**：只修复问题部分，不改变整体
2. **保持风格**：修改后文字符合原文风格
3. **因果优先**：优先解决因果链断裂问题
4. **连锁检查**：修复一处后检查是否引发新问题

### 修复输出

```
===== 修复完成 =====

已修复问题：X 个
- 🔴 第X章：[因果断裂] → 在第X段增加了信息来源说明 ✓
- 🔴 第X章：[动机缺失] → 增加了角色动机描写 ✓
- 🟡 第X章：[时间压缩] → 调整时间为3小时 ✓

跳过问题：X 个
- 🟢 第X章：[承接生硬] → 用户选择跳过

修改的文件：
- 卷X-卷名/章节/第XXX章-标题.md
- ...

========================
```

---

## 第九步：保存检查记录

1. 保存报告到 `质量检查/逻辑检查报告-卷X-日期.md`
2. 记录已修复的问题，避免重复检查

---

## 附录：逻辑问题速查表

### A. 因果逻辑常见问题

| 问题 | 特征 | 修复方向 |
|------|------|----------|
| 巧合过多 | "正好"、"恰巧"出现太多 | 改为有逻辑的安排 |
| 天降救兵 | 危急时刻有人莫名出现 | 补充出现的合理性 |
| 无果而终 | 重大事件没有后续 | 增加事件的影响 |
| 铺垫断裂 | 事件发生但没有前兆 | 前面增加铺垫 |

### B. 动机逻辑常见问题

| 问题 | 特征 | 修复方向 |
|------|------|----------|
| 无理由行动 | 角色行为没有"为什么" | 明确动机 |
| 智商下线 | 明显愚蠢的选择 | 给出合理的理由 |
| 人设崩塌 | 行为与性格矛盾 | 调整行为或增加解释 |
| 工具人化 | 配角只为剧情服务 | 赋予独立动机 |

### C. 信息逻辑常见问题

| 问题 | 特征 | 修复方向 |
|------|------|----------|
| 全知全能 | 知道不该知道的 | 补充信息来源 |
| 选择性遗忘 | 忘记该记得的 | 修正认知表现 |
| 传播断链 | 信息无渠道传播却被知道 | 增加传播路径 |

### D. 时空逻辑常见问题

| 问题 | 特征 | 修复方向 |
|------|------|----------|
| 瞬间移动 | 不合理的快速到达 | 调整时间或增加说明 |
| 时间膨胀/压缩 | 事件耗时不合理 | 调整时间设定 |
| 位置矛盾 | 同时在两个地方 | 修正位置 |

---

## 使用建议

### 检查时机

| 时机 | 推荐操作 |
|------|----------|
| 每写5-10章后 | 检查最近写的章节 |
| 写完一卷后 | 全卷逻辑检查 |
| 发现"不对劲"时 | 针对性检查相关章节 |
| 读者反馈逻辑问题时 | 定位并修复 |

### 与其他检查配合使用

```
/auto-write X Y     → 写章节
      ↓
/check-logic X Y-Z  → 逻辑检查（每5-10章）← 你在这里
      ↓
/check-consistency X Y-Z  → 一致性检查（每卷）
      ↓
/polish-chapter X Y → 润色定稿
```

---

## 注意事项

1. **上下文是关键**：检查逻辑必须读取足够的上下文
2. **人设优先**：违反人设的逻辑问题优先级最高
3. **不要过度修复**：小瑕疵可以保留，严重问题必须修
4. **连锁反应**：修复一处时检查是否引发新问题
5. **保持节奏**：修复时注意不要破坏原有的叙事节奏
